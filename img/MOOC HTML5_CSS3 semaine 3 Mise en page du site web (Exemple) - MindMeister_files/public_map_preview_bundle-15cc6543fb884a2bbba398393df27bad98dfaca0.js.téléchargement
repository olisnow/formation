webpackJsonp([160],{"3/B0":function(module,exports,__webpack_require__){module.exports=__webpack_require__("lyfy")()},Fp8Z:function(module,exports){function mm$(id){return document.getElementById(id)}function getStyle(element,style){var value=element.style[style];if(!value||"auto"==value){var css=document.defaultView?document.defaultView.getComputedStyle(element,null):null;value=css?css[style]:null}return"opacity"==style?value?parseFloat(value):1:"auto"==value?null:value}function childElements(element,iterator){var childElements=[];if(!element.hasChildNodes())return[];for(var children=element.childNodes,i=0,len=children.length;i<len;i++){var el=children[i];iterator?1==el.nodeType&&iterator.call(null,el)&&childElements.push(el):1==el.nodeType&&childElements.push(el)}return childElements}function isVisible(element){if(element.style&&"none"==element.style.display)return!1;for(var parent=element.parentNode;parent&&parent!=document;){if(parent.style&&parent.style.display&&"none"==parent.style.display)return!1;parent=parent.parentNode}return!0}function descendants(element,iterator){var desc=[];if(!element.hasChildNodes())return[];for(var children=element.childNodes,i=0,len=children.length;i<len;i++){var el=children[i];1==el.nodeType&&iterator&&iterator.call(null,el)&&desc.push(el),el.hasChildNodes()&&(desc=desc.concat(descendants(el,iterator)))}return desc}function hasAncestor(element,ancestor){for(var found=!1;element&&!found;)found=element.parentNode==ancestor,element=element.parentNode;return found}function nextSibling(element,iterator){var el=element.nextSibling;if(!el)return null;if(iterator){if(1==el.nodeType&&iterator.call(null,el))return el}else if(1==el.nodeType)return el;return nextSibling(el,iterator)}function previousSibling(element,iterator){var el=element.previousSibling;if(!el)return null;if(iterator){if(1==el.nodeType&&iterator.call(null,el))return el}else if(1==el.nodeType)return el;return previousSibling(el,iterator)}function nextTwin(element){return nextSibling(element,function(el){return el.tagName==element.tagName})}function previousTwin(element){return previousSibling(element,function(el){return el.tagName==element.tagName})}function siblings(element,iterator){return descendants(element.parentNode,function(el){return iterator.call(null,el)&&el!=element})}function getDimensionsAsArray(element){return[element.offsetWidth,element.offsetHeight]}function addClassName(element,className){element&&className&&updateClassName(element,className,function(classes,newClass){-1===classes.indexOf(newClass)&&classes.push(newClass)})}function removeClassName(element,className){element&&className&&updateClassName(element,className,function(classes,newClass){var index=classes.indexOf(newClass);index>=0&&classes.splice(index,1)})}function toggleClassName(element,className){hasClassName(element,className)?removeClassName(element,className):addClassName(element,className)}function hasClassName(element,className){return!(!element||!className)&&getClasses(element).indexOf(className)>=0}function hide(element){element.style.display="none"}function show(element){element.style.display=""}function remove(element){element.parentNode.removeChild(element)}function getDataSet(element,key){return void 0===element.dataset?element.getAttribute("data-"+key):element.dataset[key.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})]}var getClassArray=function(className){return className.split(/\s+/g)},getClasses=function(element){var className=element.getAttribute("class");return className?getClassArray(className):[]},updateClassName=function(element,className,iterator){var classes=getClasses(element);getClassArray(className).forEach(function(newClass){iterator(classes,newClass)}),element.className=classes.join(" ")};window.mm$=mm$,window.getStyle=getStyle,window.childElements=childElements,window.isVisible=isVisible,window.descendants=descendants,window.hasAncestor=hasAncestor,window.nextSibling=nextSibling,window.previousSibling=previousSibling,window.nextTwin=nextTwin,window.previousTwin=previousTwin,window.siblings=siblings,window.getDimensionsAsArray=getDimensionsAsArray,window.addClassName=addClassName,window.removeClassName=removeClassName,window.toggleClassName=toggleClassName,window.hasClassName=hasClassName,window.hide=hide,window.show=show,window.remove=remove,window.getDataSet=getDataSet},UVR0:function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__("dzP2")},dzP2:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function copyProps(context,props){var onNewComment=props.onNewComment,language=props.language,rest=_objectWithoutProperties(props,["onNewComment","language"]);for(var prop in rest)context.page[prop]=rest[prop];context.language=language,onNewComment&&(context.callbacks={onNewComment:[onNewComment]})}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__("nakD"),_react2=_interopRequireDefault(_react),_propTypes=__webpack_require__("3/B0"),_propTypes2=_interopRequireDefault(_propTypes),DISQUS_CONFIG=["shortname","identifier","title","url","category_id","onNewComment","language"],__disqusAdded=!1,DisqusThread=function(_React$Component){function DisqusThread(){return _classCallCheck(this,DisqusThread),_possibleConstructorReturn(this,(DisqusThread.__proto__||Object.getPrototypeOf(DisqusThread)).apply(this,arguments))}return _inherits(DisqusThread,_React$Component),_createClass(DisqusThread,[{key:"componentDidMount",value:function(){this.loadDisqus()}},{key:"componentDidUpdate",value:function(){this.loadDisqus()}},{key:"shouldComponentUpdate",value:function(nextProps,nextState){return nextProps.identifier!==this.props.identifier}},{key:"render",value:function(){var _this2=this,props=Object.keys(this.props).reduce(function(memo,key){return DISQUS_CONFIG.some(function(config){return config===key})?memo:_extends({},memo,_defineProperty({},key,_this2.props[key]))},{});return _react2.default.createElement("div",props,_react2.default.createElement("div",{id:"disqus_thread"}))}},{key:"addDisqusScript",value:function(){if(!__disqusAdded){var child=this.disqus=document.createElement("script"),parent=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];child.async=!0,child.type="text/javascript",child.src="//"+this.props.shortname+".disqus.com/embed.js",parent.appendChild(child),__disqusAdded=!0}}},{key:"loadDisqus",value:function(){var _this3=this,props={};DISQUS_CONFIG.forEach(function(prop){"shortname"!==prop&&_this3.props[prop]&&(props[prop]=_this3.props[prop])}),"undefined"!=typeof DISQUS?DISQUS.reset({reload:!0,config:function(){copyProps(this,props),this.page.url=this.page.url.replace(/#/,"")+"#!newthread"}}):(window.disqus_config=function(){copyProps(this,props)},this.addDisqusScript())}}]),DisqusThread}(_react2.default.Component);DisqusThread.displayName="DisqusThread",DisqusThread.propTypes={id:_propTypes2.default.string,shortname:_propTypes2.default.string.isRequired,identifier:_propTypes2.default.string,title:_propTypes2.default.string,url:_propTypes2.default.string.isRequired,category_id:_propTypes2.default.string,onNewComment:_propTypes2.default.func,language:_propTypes2.default.string},DisqusThread.defaultProps={url:window.location.href},exports.default=DisqusThread},f9O0:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(React){__webpack_require__.d(__webpack_exports__,"a",function(){return PublicMapDisqusComments}),__webpack_require__.d(__webpack_exports__,"c",function(){return getPublicMapDisqusShortname}),__webpack_require__.d(__webpack_exports__,"b",function(){return getPublicMapDisqusIdentifier});var __WEBPACK_IMPORTED_MODULE_0_react_disqus_comments__=__webpack_require__("UVR0"),__WEBPACK_IMPORTED_MODULE_0_react_disqus_comments___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react_disqus_comments__),sendNotificationMail=function(_ref){var mapId=_ref.mapId,comment=_ref.comment;new Ajax.Request("/public_maps/comments_notification/"+mapId,{parameters:{comment_id:comment.id}})},getPublicMapDisqusShortname=function(environment){return"mindmeisterpublicmaps"+("production"===environment||"production_new"===environment?"":"-"+environment)},getPublicMapDisqusIdentifier=function(mapId){return"public-"+mapId},DisqusComments=function(props){var shortname=props.shortname,disqusIdentifier=props.disqusIdentifier,title=props.title,url=props.url,_props$language=props.language,language=void 0===_props$language?"en":_props$language,_props$onNewComment=props.onNewComment,onNewComment=void 0===_props$onNewComment?function(){return null}:_props$onNewComment;return React.createElement(__WEBPACK_IMPORTED_MODULE_0_react_disqus_comments___default.a,{shortname:shortname,identifier:disqusIdentifier,title:title,url:url,language:language,onNewComment:onNewComment})},PublicMapDisqusComments=function(props){var mapId=props.mapId,title=props.title,url=props.url,environment=props.environment,locale=props.locale,localeFull=props.localeFull,_props$onNewComment2=props.onNewComment,_onNewComment=void 0===_props$onNewComment2?function(){return null}:_props$onNewComment2,language="es"===locale?localeFull:locale;return React.createElement(DisqusComments,{shortname:getPublicMapDisqusShortname(environment),identifier:getPublicMapDisqusIdentifier(mapId),title:title,url:url,language:language,onNewComment:function(comment){_onNewComment({comment:comment,mapId:mapId}),sendNotificationMail({comment:comment,mapId:mapId})}})}}).call(__webpack_exports__,__webpack_require__("nakD"))},lyfy:function(module,exports,__webpack_require__){"use strict";var emptyFunction=__webpack_require__("BLFw"),invariant=__webpack_require__("NBXI"),ReactPropTypesSecret=__webpack_require__("+Lgk");module.exports=function(){function shim(props,propName,componentName,location,propFullName,secret){secret!==ReactPropTypesSecret&&invariant(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function getShim(){return shim}shim.isRequired=shim;var ReactPropTypes={array:shim,bool:shim,func:shim,number:shim,object:shim,string:shim,symbol:shim,any:shim,arrayOf:getShim,element:shim,instanceOf:getShim,node:shim,objectOf:getShim,oneOf:getShim,oneOfType:getShim,shape:getShim};return ReactPropTypes.checkPropTypes=emptyFunction,ReactPropTypes.PropTypes=ReactPropTypes,ReactPropTypes}},ujnE:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0}),function(ReactDOM,React){var __WEBPACK_IMPORTED_MODULE_0_utils_domHelpers__=__webpack_require__("Fp8Z"),__WEBPACK_IMPORTED_MODULE_1_ui_components_disqusComments__=(__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_utils_domHelpers__),__webpack_require__("f9O0"));MM.ui.PublicMapPreview={init:function(props){this.props=props,this.likes=this.props.likes-this.props.likedByUser,this.sections=["comments","map-outline"],this.initSections(),this.likeButton=mm$("btn-like"),this.likeButton.onclick=this.onLike.bind(this),this.updateLikeButton(this.props.likedByUser),this.toggleSection("map-outline")},initSections:function(){var _this=this;this.sections.each(function(sectionName){return mm$(sectionName+"-toggle").onclick=_this.toggleSection.bind(_this,sectionName)})},toggleSection:function(newSection){if(this.sections.each(function(sectionName){removeClassName(mm$(sectionName+"-toggle"),"active"),hide(mm$(sectionName+"-wrapper"))}),addClassName(mm$(newSection+"-toggle"),"active"),show(mm$(newSection+"-wrapper")),"comments"===newSection){var map=this.props.map;ReactDOM.render(React.createElement(__WEBPACK_IMPORTED_MODULE_1_ui_components_disqusComments__.a,{mapId:map.id,title:map.title,url:map.url,environment:ServerData.env,locale:I18n.locale,localeFull:I18n.localeFull}),mm$("comments-wrapper"))}return!1},onLike:function(){var _this2=this,liked=hasClassName(this.likeButton,"liked"),_props=this.props,map=_props.map;_props.userCanLike?new Ajax.Request("/maps/like.json",{asynchronous:!0,evalScripts:!0,parameters:{map_id:map.id,unlike:liked},onComplete:function(transport){return _this2.updateLikeButton(transport.responseJSON.liked)}}):window.location.href="/account/login?return_to="+window.location.href},updateLikeButton:function(liked){liked?addClassName(this.likeButton,"liked"):removeClassName(this.likeButton,"liked"),mm$("like_counter").textContent=this.likes+liked}}}.call(__webpack_exports__,__webpack_require__("x9tB"),__webpack_require__("nakD"))}},["ujnE"]);